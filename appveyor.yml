# version format
version: "{build}"

image: Visual Studio 2015
platform: x64
configuration: release

clone_folder: C:\projects\petmr-RESOLUTE

environment:
  GLOGINSTALL: C:\projects\deps\glog-INSTALL
  GLOGBUILD: C:\projects\deps\glog-BUILD
  ANTSBUILD: C:\projects\deps\antsbin

install:
  - IF NOT EXIST C:\projects\deps mkdir C:\projects\deps
  - cd C:\projects\deps
  - set GLOG_URL="https://github.com/google/glog"
  - git clone -b v0.3.5 %GLOG_URL%
  - IF NOT EXIST %GLOGINSTALL% (
     mkdir %GLOGBUILD% &&
     cd %GLOGBUILD% &&
     cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX="%GLOGINSTALL%" ..\glog &&
     msbuild INSTALL.vcxproj)
  - cd C:\projects\deps
  - set ANTS_URL="https://github.com/ANTsX/ANTs.git"
  - git clone -b v2.2.0 %ANTS_URL%
  - IF NOT EXIST %ANTSBUILD% (
     mkdir %ANTSBUILD% &&
     cd %ANTSBUILD% &&
     cmake -DCMAKE_BUILD_TYPE=Release ..\ANTs &&
     msbuild BUILD.vcxproj)

cache:
  - C:\projects\deps\ANTs
  - C:\projects\deps\antsbin

build_script:
  - cd C:\projects\petmr-RESOLUTE
